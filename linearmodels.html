<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Linear Regression Models</title>
    <meta charset="utf-8" />
    <meta name="author" content="Chuck Cleland" />
    <meta name="date" content="2022-02-24" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Linear Regression Models
### Chuck Cleland
### NYU Grossman School of Medicine, Department of Population Health
### February 24, 2022

---


&lt;style type="text/css"&gt;
.remark-slide-content {
  font-size: 30px;
  padding: 20px 20px 20px 20px;
}
.remark-code, .remark-inline-code {
  background: #f0f0f0;
}
.remark-code {
  font-size: 16px;
}
.huge .remark-code { /*Change made here*/
  font-size: 500% !important;
}
.tiny .remark-code { /*Change made here*/
  font-size: 11px !important;
}

.large { font-size: 130% }
.small { font-size: 70% }

.my-one-page-font {
  font-size: 24px;
}
&lt;/style&gt;









# Variables and Constants

.large[
- Any characteristic that varies from one individual to another can be called a *variable*.
- Most psychological research is concerned with relations among variables.
- An example of a variable is sleep latency -- the time it takes an individual to fall asleep.
- If sleep latency were exactly the same for all people, it would be a *constant*.
]
---

# Scales of Measurement
.large[
- Measurement is a system for assigning values to observations (people) in a consistent and reproducible way.
- Measurement need not involve numbers as it could consist of classifying objects (people) into distinct categories (e.g., urban vs. rural residence).
]
---

# Nominal Scales

**Nominal scales** are used to assign objects (people) to
distinct, named categories.  If these categories are assigned
numbers, those number are arbitrary and cannot be used for
mathematical operations.  As an example of a nominal scale, facial
expressions may be classified by the emotion expressed (e.g.,
anger, happiness, disgust).  Many variables important to
psychology (e.g., type of therapy, gender) can be measured only on
a nominal scale.  An object (person) with a specific value for a
nominal scale (e.g., female) does not have more or less of
something than another object with a different value (male);
rather, objects differ by kind, not amount.
---

# Ordinal Scales
**Ordinal scales** rank objects (people) according to the
amount of an attribute they posses.  For example, student
handwriting may be rated as excellent, good, fair, or poor.  Some
mathematical operations are permissible for variables which have
ordinal properties.  For example, the percentage of excellent and
fair students can be added to say something about the percentage
of students who have better than fair handwriting.
---

# Interval Scales
In general, physical measurements have a level of precision that
goes beyond the ordinal properties.  Measurement scales with more
than just ordinal properties are based on units of equal size.  A
unit at one part of the scale is the same size as a unit at any
other part of the scale.  Scales which have this property are
called **interval scales**.
---

# Ratio Scales
Scales which have a non-arbitrary zero point, in addition to equal
units, are called **ratio scales**.  Such scales allow us to
say, for example, that a sleep latency of 10 minutes is twice as
short as a sleep latency of 20 minutes.  Many scales in social research
technically do not have this property.  For example, asserting
that is twice as depressed as Tom implies that a depression
scale can identify, in a non-arbitrary way, what zero depression
is.
---

# Continuous and Discrete Variables
- A variable which can take on any value within a specified range for a particular object (person) is a continuous variable.
- A variable (e.g., charisma) may be theoretically continuous even though a particular measurement of the variable may have only ordinal properties.
- Thus, it is important not to confuse the variables with the scales with which they are measured.
---

# Simple linear regression model

`$$Y_{i}=\beta_0 + \beta_1 X_{i} + \epsilon_{i}$$`

- `\(\beta_0\)` is an intercept
- `\(\beta_1\)` is a slope (regression coefficient)
- `\(Y_{i}\)` is an outcome, response, or dependent variable score for person *i*
- `\(X_{i}\)` is a predictor, explanatory, or independent variable score for person *i*
- `\(\epsilon_{i}\)` is a residual for person *i*, the difference between between `\(Y_{i}\)` and `\(\beta_0 + \beta_1 X_{i}\)`
---

# Multiple Regression

---

# t-tests and Analysis of Variance as Linear Models


```r
DT &lt;- readr::read_csv("ex0222.csv", col_types = c("i","f"))
```


```r
t.test(CHOLESTEROL ~ GROUP, data = DT, var.equal = TRUE)
```

```

	Two Sample t-test

data:  CHOLESTEROL by GROUP
t = -8.0782, df = 92, p-value = 2.476e-12
alternative hypothesis: true difference in means between group RURAL and group URBAN is not equal to 0
95 percent confidence interval:
 -74.58536 -45.14798
sample estimates:
mean in group RURAL mean in group URBAN 
           157.0000            216.8667 
```
---


```r
summary(lm(CHOLESTEROL ~ GROUP, data = DT))
```

```

Call:
lm(formula = CHOLESTEROL ~ GROUP, data = DT)

Residuals:
   Min     1Q Median     3Q    Max 
-83.87 -20.97  -7.00  18.85 113.13 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  157.000      5.128  30.619  &lt; 2e-16 ***
GROUPURBAN    59.867      7.411   8.078 2.48e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 35.89 on 92 degrees of freedom
Multiple R-squared:  0.415,	Adjusted R-squared:  0.4086 
F-statistic: 65.26 on 1 and 92 DF,  p-value: 2.476e-12
```
---

# Dummy Coding 

---

# Effect Coding 

---

# Interaction Effects 

---

# Comparisons and Contrasts After Fitting

---

# Accomodating Non-Linear Relations in Linear Regression Models

---

# Simulating Data from a Linear Regression Model

---

class: center

# Logistic regression model

`$$\log_e(\frac{\pi_{i}}{1 - \pi_{i}})=\beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + ... + \beta_p x_{pi}$$`

where

`\(\pi_i = E[y_i]\)` and

`\(y_i\)` is a binary outcome

---

# Interpretation of regression coefficients

- The intercept coefficient (or constant) is the mean of the outcome when all variables on the right-hand side of the linear regression are held constant at 0
- Each of the other coefficients represents how the mean of the outcome changes for a 1-unit change in the variable

---

# Prediction from the model

- For any hypothetical case/observation, one can combine a covariate pattern with the model coefficients for a linear predictor (which is the expected value of the outcome)

---

class: my-one-page-font

# How accurate is our prediction?

- Residual standard error (standard deviation of residuals) measures the typical difference between a model prediction and an observed value
- Plot observed values against predicted values

---

# Checking model assumptions and goodness of fit

- Internal validation via bootstrapping
- External validation (predict new cases from a previously built model)
- Calibration curve

---

class: middle, center

# Snippet of the data

---

# Model building strategies

.pull-left[
- Depends on your inferential goal (prediction, primary exposure effect, relative importance)
- Bivariate screening (not recommended)
- Forward stepwise (not recommended)
- Backward elimination (if you must simplify)
- Change in coefficient estimates
]

.pull-right[
- Simplify right-hand side as much as possible without considering the outcome
- Allow for non-linear and interaction terms
- Rule of thumb: ten **events** per predictor
- Model selection complicates inference
- See E. Vittinghoff et al., _Regression Methods in Biostatistics_ (Chapter 10)
]

---

# Sample size, power, and effect size

- A modest population mean difference between groups requires a large sample size for reliable detection


```r
power.t.test(delta = .2, power = .8)
```

```

     Two-sample t test power calculation 

              n = 393.4067
          delta = 0.2
             sd = 1
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group
```

---

class: middle, center

# How sample size needed for 80% power changes as a function of effect size



```
     es Row   n
1: 0.20   1 788
2: 0.25   2 506
3: 0.30   3 352
4: 0.35   4 260
5: 0.40   5 200
6: 0.45   6 158
7: 0.50   7 128
```

---

class: middle, center

&lt;img src="linearmodels_files/figure-html/unnamed-chunk-9-1.svg" style="display: block; margin: auto;" /&gt;

---

# Some extensions of linear regression

- Generalized linear models
- Generalized additive models
- Multilevel or mixed-effects regression
- Structural equation models

---

# References

.small[
- Baguley, T. (2012). Serious stats: A guide to advanced statistics for the behavioral sciences. Macmillan International Higher Education.
- Flora, D. B. (2017). Statistical methods for the social and behavioural sciences: A model-based approach. Sage.
- Fox, J. (2016). Applied regression analysis and generalized linear models(3rd ed.). Sage.
- Harrell, F.E. (2015). Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis. Springer.
- Vittinghoff, E., Glidden, D.V., McCulloch, C.E., Shiboski, S.C. (2012). Regression Methods in Biostatistics: Linear, Logistic, Survival, and Repeated Measures Models. Springer.
]
---

class: center, middle

# Thanks!

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
(function(time) {
  var d2 = function(number) {
    return ('0' + number).slice(-2); // left-pad 0 to minutes/seconds
  },

  time_format = function(total) {
    var secs = Math.abs(total) / 1000;
    var h = Math.floor(secs / 3600);
    var m = Math.floor(secs % 3600 / 60);
    var s = Math.round(secs % 60);
    var res = d2(m) + ':' + d2(s);
    if (h > 0) res = h + ':' + res;
    return res;  // [hh:]mm:ss
  },

  slide_number_div = function(i) {
    return document.getElementsByClassName('remark-slide-number').item(i);
  },

  current_page_number = function(i) {
    return slide_number_div(i).firstChild.textContent;  // text "i / N"
  };

  var timer = document.createElement('span'); timer.id = 'slide-time-left';
  var time_left = time, k = slideshow.getCurrentSlideIndex(),
      last_page_number = current_page_number(k);

  setInterval(function() {
    time_left = time_left - 1000;
    timer.innerHTML = ' ' + time_format(time_left);
    if (time_left < 0) timer.style.color = 'red';
  }, 1000);

  slide_number_div(k).appendChild(timer);

  slideshow.on('showSlide', function(slide) {
    var i = slide.getSlideIndex(), n = current_page_number(i);
    // reset timer when a new slide is shown and the page number is changed
    if (last_page_number !== n) {
      time_left = time; last_page_number = n;
      timer.innerHTML = ' ' + time_format(time); timer.style.color = null;
    }
    slide_number_div(i).appendChild(timer);
  });
})(60000);
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
